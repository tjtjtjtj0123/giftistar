<!--이용자 계좌조회(AP400)-->
@using test211005.Models
@model dynamic
<h2>이용자 계좌조회</h2>
<hr />
<p>※ 검색 시, 하단에 검색된 이용자의 정보가 표시됩니다.</p>
<table>
    <tr>
        <th>아이디</th>
        <td><input type="text" class="form-control" id="userId"/></td>
        <td><input class="btn btn-warning" type="button" id="checkUser" value="선택"></td>
    </tr>
</table>
<br />
<table class="table table-sm">
    <tr>
        <th style="text-align:left">고객번호</th>
        <td><span id="IuserNo" /></td>
        <th style="text-align:left">아이디</th>
        <td><span id="IuserId" /></td>
        <th style="text-align:left">이름</th>
        <td><span id="IuserName" /></td>
    </tr>
    <tr>
        <th style="text-align:left">생년월일</th>
        <td><span id="Ibirth" /></td>
        <th style="text-align:left">가입일</th>
        <td><span id="IregDate" /></td>
        <td colspan="2"></td>
    </tr>
    <tr>
        <td colspan="6"></td>
    </tr>
</table>
<hr />
<p>※ 이용자의 계좌 상태, 결제/구매/판매/PG 로그 내역을 모두 조회할 수 있습니다.</p>
<table>
    <tr>
        <th>기간</th>
        <td>
            <div class="tui-datepicker-input tui-datetime-input tui-has-focus form-control" style="z-index:1000">
                <input id="startDate" type="text" aria-label="Date" style="outline:none">
                <span class="tui-ico-date"></span>
                <div id="startpicker-container" style="margin-left: -1px;"></div>
            </div>
            <span>&nbsp;&nbsp;~&nbsp;&nbsp;</span>
            <div class="tui-datepicker-input tui-datetime-input tui-has-focus form-control" style="z-index:1000">
                <input id="endDate" type="text" aria-label="Date" style="outline:none">
                <span class="tui-ico-date"></span>
                <div id="endpicker-container" style="margin-left: -1px;"></div>
            </div>
            <div id="wrapper2" style="margin-top: -1px;"></div>
        </td>
        <td>
            <input class="btn btn-warning" type="button" id="filter" value="조회">
        </td>
    </tr>
</table>
<br />
<input type="button" value="계좌 상태" class="btn btn-warning" id="showAccountStatus" />
<input type="button" value="결제 내역" class="btn btn-warning" id="showCashList" />
<input type="button" value="구매 내역" class="btn btn-warning" id="showPurchaseList" />
<input type="button" value="판매 내역" class="btn btn-warning" id="showSellingList" />
<input type="button" value="PG로그 내역" class="btn btn-warning" id="showPGLogList" />
<input type="button" value="전체 내역" class="btn btn-warning" id="showAllList" />
<br />
<h3 id="title"></h3>
<table class="table table-sm" id="tablList"></table>
<div class="text-center">
    <!--페이징처리 - 충전 내역 페이지-->
    <div class="btn-group" id="pageBtn">
    </div>
</div>
@section Scripts {
    <script>
        var isExist = 0;
        var filterCheck = 0;
        var userNo = 0;
        var startDate = null;
        var endDate = null;

        /*조회 버튼*/
        $('#filter').click(function () {
            if (userNo != 0) {
                startDate = $('#startDate').val();
                endDate = $('#endDate').val();
                console.log(startDate);
                console.log(endDate);
                var urlData = '@Url.Action("ShowUserTotalCash", "Admin")' + "?&UserNo=" + userNo;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#pageBtn').empty();
                        $('#tablList').empty(); // 테이블 비우기
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TH>총 기프티캐시</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TD colspan=\"2\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>충전 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>보너스 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>판매금 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TD colspan=\"2\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TD colspan=\"4\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 충전 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 충전 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 보너스 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 보너스 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 판매금 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 판매금 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TD colspan=\"4\"></TD>"
                            str += "</TR>"
                        });
                        $("#tablList").append(str);
                        document.getElementById("title").innerHTML = "계좌 상태";
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                });
            }
        })

        /*PG 로그 내역 클릭 버튼*/
        $(document).on("click", ".PGBtn", function () { // ajax 호출 후, 버튼 누른경우 -- 구매내역
            if (userNo != 0) {
                var pageNumber = $(this).data("no");;
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserPGLogByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo + "&page=" + pageNumber;
                else
                    urlData = '@Url.Action("ShowUserPGLog", "Admin")' + "?&UserNo=" + userNo + "&page=" + pageNumber;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        var totalRowCount = 0;
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TH scope=\"col\">주문 번호</TH>"
                        str += "<TH scope=\"col\">결제 수단</TH>"
                        str += "<TH scope=\"col\">결제 정보</TH>"
                        str += "<TH scope=\"col\">결제 금액</TH>"
                        str += "<TH scope=\"col\">승인 결과</TH>"
                        str += "<TH scope=\"col\">등록 일시</TH>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.OrderNo + "</TD>"
                            str += "<TD>" + val.PaymentStr + "</TD>"
                            str += "<TD>캐시 충전</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargePaidAmountStr + "</TD>"
                            str += "<TD>"
                            if (val.ApprovalStatus == "성공")
                                str += "<font color=\"blue\">"
                            str += val.ApprovalStatus
                            if (val.ApprovalStatus == "성공")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "</TR>"
                            totalRowCount = parseInt(val.TotalRowCount, 10);
                        });
                        var totalPageCount = totalRowCount / 10;
                        if (totalRowCount % 10 != 0) // 마지막 페이지set에 페이지수가 5개 아닌 경우
                            totalPageCount++;
                        var start = 1;
                        var pageStr = "";
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"
                        console.log(totalPageCount);
                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "PG 로그 내역";

                    }, error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                })
            }
        })

        /*PG 로그 내역 버튼*/
        $('#showPGLogList').click(function () {
            if (userNo != 0) {
                var pageNumber = 1;
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserPGLogByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo;
                else
                    urlData = '@Url.Action("ShowUserPGLog", "Admin")' + "?&UserNo=" + userNo;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        var totalRowCount = 0;
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TH scope=\"col\">주문 번호</TH>"
                        str += "<TH scope=\"col\">결제 수단</TH>"
                        str += "<TH scope=\"col\">결제 정보</TH>"
                        str += "<TH scope=\"col\">결제 금액</TH>"
                        str += "<TH scope=\"col\">승인 결과</TH>"
                        str += "<TH scope=\"col\">등록 일시</TH>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.OrderNo + "</TD>"
                            str += "<TD>" + val.PaymentStr + "</TD>"
                            str += "<TD>캐시 충전</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargePaidAmountStr + "</TD>"
                            str += "<TD>"
                            if (val.ApprovalStatus == "성공")
                                str += "<font color=\"blue\">"
                            str += val.ApprovalStatus
                            if (val.ApprovalStatus == "성공")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "</TR>"
                            totalRowCount = parseInt(val.TotalRowCount, 10);
                        });
                        var totalPageCount = totalRowCount / 10;
                        if (totalRowCount % 10 != 0) // 마지막 페이지set에 페이지수가 5개 아닌 경우
                            totalPageCount++;
                        var start = 1;
                        var pageStr = "";
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"
                        console.log(totalPageCount);
                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"PGBtn\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "PG 로그 내역";

                    }, error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                })
            }
        })

        /*전체 내역 버튼*/
        $('#showAllList').click(function () {
            if (userNo != 0) {
                var pageNumber = 1;
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserAllListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo;
                else
                    urlData = '@Url.Action("ShowUserAllList", "Admin")' + "?UserNo=" + userNo;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TH scope=\"col\">일시</TH>"
                        str += "<TH scope=\"col\">충전 수단</TH>"
                        str += "<TH scope=\"col\">결제 금액</TH>"
                        str += "<TH scope=\"col\">충전 캐시 금액(원)</TH>"
                        str += "<TH scope=\"col\">상품명</TH>"
                        str += "<TH scope=\"col\">사용 캐시 금액</TH>"
                        str += "<TH scope=\"col\">상태</TH>"
                        str += "</TR>"
                        str += "</THEAD>"
                        var totalRowCount = 0;
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>" + val.Payment + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargePaidAmount + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargeCashAmount + "</TD>"
                            str += "<TD>" + val.ItemName + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.TotalPrice + "</TD>"
                            str += "<TD>"
                            if (val.Status == "취소")
                                str += "<font color=\"red\">"
                            str += val.Status
                            if (val.Status == "취소")
                                str += "</font>"
                            str += "</TD>"
                            str += "</TR>"
                            totalRowCount = parseInt(val.TotalRowCount, 10);
                        });
                        var totalPageCount = totalRowCount / 10;
                        if (totalRowCount % 10 != 0) // 마지막 페이지set에 페이지수가 5개 아닌 경우
                            totalPageCount++;
                        var start = 1;
                        var pageStr = "";
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "전체 내역";

                    }, error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                })
            }
        })

        /*전체 내역 클릭 버튼*/
        $(document).on("click", ".showAll", function () { // ajax 호출 후, 버튼 누른경우 -- 구매내역
            if (userNo != 0) {
                var pageNumber = $(this).data("no");
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserAllListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo + "&page=" + pageNumber;
                else
                    urlData = '@Url.Action("ShowUserAllList", "Admin")' + "?UserNo=" + userNo + "&page=" + pageNumber;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TH scope=\"col\">일시</TH>"
                        str += "<TH scope=\"col\">충전 수단</TH>"
                        str += "<TH scope=\"col\">결제 금액</TH>"
                        str += "<TH scope=\"col\">충전 캐시 금액(원)</TH>"
                        str += "<TH scope=\"col\">상품명</TH>"
                        str += "<TH scope=\"col\">사용 캐시 금액</TH>"
                        str += "<TH scope=\"col\">상태</TH>"
                        str += "</TR>"
                        str += "</THEAD>"
                        var totalRowCount = 0;
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>" + val.Payment + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargePaidAmount + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargeCashAmount + "</TD>"
                            str += "<TD>" + val.ItemName + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.TotalPrice + "</TD>"
                            str += "<TD>"
                            if (val.Status == "취소")
                                str += "<font color=\"red\">"
                            str += val.Status
                            if (val.Status == "취소")
                                str += "</font>"
                            str += "</TD>"
                            str += "</TR>"
                            totalRowCount = val.TotalRowCount;
                        });
                        var totalPageCount = totalRowCount / 10;
                        if (totalRowCount % 10 != 0) // 마지막 페이지set에 페이지수가 5개 아닌 경우
                            totalPageCount++;
                        var start = 1;
                        var pageStr = "";
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"showAll\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "전체 내역";

                    }, error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                })
            }
        })

        /*구매 내역 버튼*/
        $('#showPurchaseList').click(function () {
            if (userNo != 0) {
                var pageNumber = 1;
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserPurchaseListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo;
                else
                    urlData = '@Url.Action("ShowUserPurchaseList", "Admin")' + "?UserNo=" + userNo;

                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        var totalPageCount = 0;
                        str += "<THEAD>"
                        str += "<th style=\"width: 5%; vertical-align:middle\">번호</th>"
                        str += "<th style=\"width: 5%;vertical-align:middle\">고객<br>번호</th>"
                        str += "<th style=\"width: 8%;vertical-align:middle\">아이디</th>"
                        str += "<th style=\"vertical-align:middle\">상품명</th>"
                        str += "<th style=\"vertical-align:middle\">캐시 결제 총액(원)</th>"
                        str += "<th style=\"vertical-align:middle\">거래 상태</th>"
                        str += "<th style=\"vertical-align:middle\">구매 일시</th>"
                        str += "<th style=\"vertical-align:middle\">취소 일시</th>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.PurchaseNo + "</TD>"
                            str += "<TD>" + val.UserNo + "</TD>"
                            str += "<TD>" + val.UserId + "</TD>"
                            str += "<TD style=\"font-size:small\">" + val.ItemName + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.TotalPrice.toLocaleString('ko-KR') + "원</TD>"
                            str += "<TD>"
                            if (val.PurchaseStatusStr == "취소")
                                str += "<font color=\"red\">"
                            str += val.PurchaseStatusStr
                            if (val.PurchaseStatusStr == "취소")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>" + val.RefundDate + "</TD>"
                            str += "</TR>"
                            totalPageCount = parseInt(val.TotalPageCount, 10);
                            console.log(totalPageCount);
                        });
                        var start = 1;
                        var pageStr = "";
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "구매내역";
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                })
            }
        })

        $(document).on("click", ".purchase", function () { // ajax 호출 후, 버튼 누른경우 -- 구매내역
            var pageNumber = $(this).data("no");
            var urlData = "";
            if (startDate != null)
                urlData = '@Url.Action("ShowUserPurchaseListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo + "&page=" + pageNumber;
            else
                urlData = '@Url.Action("ShowUserPurchaseList", "Admin")' + "?UserNo=" + userNo + "&page=" + pageNumber;

            $.ajax({
                type: "GET",            // HTTP method type(GET, POST) 형식이다.
                url: urlData,            // Json 형식의 데이터이다.
                success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                    var objJson = jQuery.parseJSON(data);
                    var dataLength = Object.keys(objJson).length;
                    var str = "";
                    $('#tablList').empty();
                    $('#pageBtn').empty();
                    str += "<THEAD>"
                    str += "<th style=\"width: 5%; vertical-align:middle\">번호</th>"
                    str += "<th style=\"width: 5%;vertical-align:middle\">고객<br>번호</th>"
                    str += "<th style=\"width: 8%;vertical-align:middle\">아이디</th>"
                    str += "<th style=\"vertical-align:middle\">상품명</th>"
                    str += "<th style=\"vertical-align:middle\">캐시 결제 총액(원)</th>"
                    str += "<th style=\"vertical-align:middle\">거래 상태</th>"
                    str += "<th style=\"vertical-align:middle\">구매 일시</th>"
                    str += "<th style=\"vertical-align:middle\">취소 일시</th>"
                    str += "</TR>"
                    str += "</THEAD>"
                    var totalPageCount = 0;
                    $.each(objJson, function (i, val) {
                        str += "<TR>"
                        str += "<TD>" + val.PurchaseNo + "</TD>"
                        str += "<TD>" + val.UserNo + "</TD>"
                        str += "<TD>" + val.UserId + "</TD>"
                        str += "<TD style=\"font-size:small\">" + val.ItemName + "</TD>"
                        str += "<TD style=\"text-align:right\">" + val.TotalPrice.toLocaleString('ko-KR') + "원</TD>"
                        str += "<TD>"
                        if (val.PurchaseStatusStr == "취소")
                            str += "<font color=\"red\">"
                        str += val.PurchaseStatusStr
                        if (val.PurchaseStatusStr == "취소")
                            str += "</font>"
                        str += "</TD>"
                        str += "<TD>" + val.RegDate + "</TD>"
                        str += "<TD>" + val.RefundDate + "</TD>"
                        str += "</TR>"
                        totalPageCount = parseInt(val.TotalPageCount, 10);
                        console.log(totalPageCount);
                    });
                    /*페이징 번호*/
                    pageStr = "";
                    console.log(pageNumber);
                    var start = parseInt((pageNumber - 1) / 5, 10) * 5 + 1;
                    console.log(start);
                    if (start != 1)
                        pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                    if (start == (parseInt((totalPageCount - 1) / 5, 10) * 5 + 1)) { // 마지막 페이지Set인지 확인
                        var count = totalPageCount - start;
                        for (var i = start; i <= totalPageCount; i++) {
                            pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                            if (pageNumber == i)
                                pageStr += "warning\">"
                            else
                                pageStr += "default\">"
                            pageStr += i + "</div></a>"
                        }
                    } else {
                        for (var i = start; i < start + 5; i++) {
                            pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                            if (pageNumber == i)
                                pageStr += "warning\">"
                            else
                                pageStr += "default\">"
                            pageStr += i + "</div></a>"
                        }
                        pageStr += "<a href=\"javascript:void(0);\" class=\"purchase\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                    }
                    $("#tablList").append(str);
                    if (dataLength != 0)
                        $("#pageBtn").append(pageStr);
                    else
                        $('#pageBtn').empty();
                    document.getElementById("title").innerHTML = "구매내역";

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                    alert("통신 실패.")
                }
            });
        });

        /*판매 내역 버튼*/
        $('#showSellingList').click(function () {
            var pageNumber = 1;
            var totalPageCount = 0;
            if (userNo != 0) {
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserSellingListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo;
                else
                    urlData = '@Url.Action("ShowUserSellingList", "Admin")' + "?UserNo=" + userNo;
                console.log(urlData);
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TR>"
                        str += "<th style=\"width:8%; vertical-align:middle\">번호</th>"
                        str += "<th style=\"width:8%; vertical-align:middle\">고객<br>번호</th>"
                        str += "<th style=\"width:8%; vertical-align:middle\">판매자<br />아이디</th>"
                        str += "<th style=\"vertical-align:middle\">상품명</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매금 캐시 금액<br>(원)</th>"
                        str += "<th style=\"width:15%; vertical-align:middle\">판매상태</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매 등록 일시</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매 일시</th>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.GifticonNo + "</TD>"
                            str += "<TD>" + val.UserNo + "</TD>"
                            str += "<TD>" + val.UserId + "</TD>"
                            str += "<TD style=\"font-size:small\">" + val.ItemName + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ItemSellingPrice.toLocaleString('ko-KR') + "원</TD>"
                            str += "<TD>"
                            if (val.SellingStatus == "판매완료")
                                str += "<font color=\"green\">"
                            else if (val.SellingStatus == "판매불가")
                                str += "<font color=\"red\">"
                            str += val.SellingStatus
                            if (val.SellingStatus == "판매완료" || val.SellingStatus == "판매불가")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>" + val.SoldDate + "</TD>"
                            str += "</TR>"
                            totalPageCount = parseInt(val.TotalPageCount, 10);
                            console.log(totalPageCount);
                        });
                        /*페이징 번호*/
                        var pageStr = "";
                        var start = 1;
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"
                        if (start == (parseInt((totalPageCount - 1) / 5, 10) * 5 + 1)) { // 마지막 페이지Set인지 확인
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        console.log(pageStr);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        $("#tablList").append(str);
                        document.getElementById("title").innerHTML = "판매 내역";
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                });
            }
        })

        $(document).on("click", ".selling", function () { // ajax 호출 후, 버튼 누른경우 -- 구매내역
            var pageNumber = $(this).data("no");
            var totalPageCount = 0;
            if (userNo != 0) {
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserSellingListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo + "&page=" + pageNumber;
                else
                    urlData = '@Url.Action("ShowUserSellingList", "Admin")' + "?UserNo=" + userNo + "&page=" + pageNumber;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TR>"
                        str += "<th style=\"width:8%; vertical-align:middle\">번호</th>"
                        str += "<th style=\"width:8%; vertical-align:middle\">고객<br>번호</th>"
                        str += "<th style=\"width:8%; vertical-align:middle\">판매자<br />아이디</th>"
                        str += "<th style=\"vertical-align:middle\">상품명</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매금 캐시 금액<br>(원)</th>"
                        str += "<th style=\"width:15%; vertical-align:middle\">판매상태</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매 등록 일시</th>"
                        str += "<th style=\"vertical-align:middle; width:15%\">판매 일시</th>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TD>" + val.GifticonNo + "</TD>"
                            str += "<TD>" + val.UserNo + "</TD>"
                            str += "<TD>" + val.UserId + "</TD>"
                            str += "<TD style=\"font-size:small\">" + val.ItemName + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ItemSellingPrice.toLocaleString('ko-KR') + "원</TD>"
                            str += "<TD>"
                            if (val.SellingStatus == "판매완료")
                                str += "<font color=\"green\">"
                            else if (val.SellingStatus == "판매불가")
                                str += "<font color=\"red\">"
                            str += val.SellingStatus
                            if (val.SellingStatus == "판매완료" || val.SellingStatus == "판매불가")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>" + val.SoldDate + "</TD>"
                            str += "</TR>"
                            totalPageCount = parseInt(val.TotalPageCount, 10);
                            console.log(totalPageCount);
                        });
                        /*페이징 번호*/
                        pageStr = "";
                        console.log(pageNumber);
                        var start = parseInt((pageNumber - 1) / 5, 10) * 5 + 1;
                        console.log(start);
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                        if (start == (parseInt((totalPageCount - 1) / 5, 10) * 5 + 1)) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"selling\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                });
            }
        });

        /*결제 내역 버튼 -  완료*/
        $('#showCashList').click(function () {
            var pageNumber = 1;
            if (userNo != 0) { // 유저가 검색 되었을 때만 실행
                var urlData = "";
                if (startDate != null)
                    urlData = '@Url.Action("ShowUserChargeListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo;
                else
                    urlData = '@Url.Action("ShowUserChargeList", "Admin")' + "?UserNo=" + userNo;
                console.log(urlData);
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty();
                        $('#pageBtn').empty();
                        str += "<THEAD>"
                        str += "<TR>"
                        str += "<th style=\"width:5%; vertical-align:middle\">번호</th>"
                        str += "<th style=\"width:5%; vertical-align:middle\">고객<br>번호</th>"
                        str += "<th style=\"vertical-align:middle\">아이디</th>"
                        str += "<th style=\"vertical-align:middle; width:10%\">결제 수단</th>"
                        str += "<th style=\"vertical-align:middle; width:10%\">결제 금액</th>"
                        str += "<th style=\"vertical-align:middle\">캐시 충전 금액(원)</th>"
                        str += "<th style=\"vertical-align:middle; width:10%\">잔액(원)</th>"
                        str += "<th style=\"vertical-align:middle; width:5%\">결제<br>상태</th>"
                        str += "<th style=\"vertical-align:middle\">결제 일시</th>"
                        str += "<th style=\"vertical-align:middle\">취소 일시</th>"
                        str += "</TR>"
                        str += "</THEAD>"
                        $.each(objJson, function (i, val) {
                            console.log(val.ChargeNo);
                            str += "<TR>"
                            str += "<TD>" + val.ChargeNo + "</TD>"
                            str += "<TD>" + val.UserNo + "</TD>"
                            str += "<TD>" + val.UserId + "</TD>"
                            str += "<TD>" + val.Payment + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargePaidAmount + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.ChargeCashAmount.toLocaleString('ko-KR') + "원" + "</TD>"
                            str += "<TD style=\"text-align:right\">" + val.CashRemain.toLocaleString('ko-KR') + "원" + "</TD>"
                            str += "<TD>"
                            if (val.CashStatus == "취소")
                                str += "<font color=\"red\">"
                            str += val.CashStatus
                            if (val.CashStatus == "취소")
                                str += "</font>"
                            str += "</TD>"
                            str += "<TD>" + val.RegDate + "</TD>"
                            str += "<TD>"
                            str += val.RefundDate
                            str += "</TD>"
                            str += "</TR>"
                            totalPageCount = parseInt(val.TotalPageCount, 10);
                            console.log(totalPageCount);
                        });
                        pageStr = "";
                        var start = 1;
                        /*페이징 번호*/
                        if (start != 1)
                            pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"
                        var lastPage = parseInt((totalPageCount - 1) / 5, 10) * 5 + 1;
                        console.log(lastPage);
                        if (start == lastPage) { // 마지막 페이지Set인지 확인
                            var count = totalPageCount - start;
                            for (var i = start; i <= totalPageCount; i++) {
                                console.log(i);
                                pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                        } else {
                            for (var i = start; i < start + 5; i++) {
                                pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                                if (pageNumber == i)
                                    pageStr += "warning\">"
                                else
                                    pageStr += "default\">"
                                pageStr += i + "</div></a>"
                            }
                            pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                        }
                        $("#tablList").append(str);
                        if (dataLength != 0)
                            $("#pageBtn").append(pageStr);
                        else
                            $('#pageBtn').empty();
                        document.getElementById("title").innerHTML = "결제 내역";

                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                });
            }
        })

        $(document).on("click", ".chargeBtn", function () { // ajax 호출 후, 버튼 누른경우
            startDate = $('#startDate').val();
            endDate = $('#endDate').val();
            console.log("-*-----------------------------");
            var pageNumber = $(this).data("no");
            console.log(pageNumber);
            var urlDate = "";
            var urlData = "";
            if (startDate != null)
                urlData = '@Url.Action("ShowUserChargeListByDate", "Admin")' + "?StartDate=" + startDate + "&EndDate=" + endDate + "&UserNo=" + userNo + "&page=" + pageNumber;
            else
                urlData = '@Url.Action("ShowUserChargeList", "Admin")' + "?UserNo=" + userNo + "&page=" + pageNumber;
            $.ajax({
                type: "GET",            // HTTP method type(GET, POST) 형식이다.
                url: urlData,            // Json 형식의 데이터이다.
                success: function (data) { // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
                    var objJson = jQuery.parseJSON(data);
                    var dataLength = Object.keys(objJson).length;
                    var str = "";
                    $('#tablList').empty();
                    $("#pageBtn").empty();
                    str += "<THEAD>"
                    str += "<TR>"
                    str += "<th style=\"width:5%; vertical-align:middle\">번호</th>"
                    str += "<th style=\"width:5%; vertical-align:middle\">고객<br>번호</th>"
                    str += "<th style=\"vertical-align:middle\">아이디</th>"
                    str += "<th style=\"vertical-align:middle; width:10%\">결제 수단</th>"
                    str += "<th style=\"vertical-align:middle; width:10%\">결제 금액</th>"
                    str += "<th style=\"vertical-align:middle\">캐시 충전 금액(원)</th>"
                    str += "<th style=\"vertical-align:middle; width:10%\">잔액(원)</th>"
                    str += "<th style=\"vertical-align:middle; width:5%\">결제<br>상태</th>"
                    str += "<th style=\"vertical-align:middle\">결제 일시</th>"
                    str += "<th style=\"vertical-align:middle\">취소 일시</th>"
                    str += "</TR>"
                    str += "</THEAD>"
                    $.each(objJson, function (i, val) {
                        str += "<TR>"
                        str += "<TD>" + val.ChargeNo + "</TD>"
                        str += "<TD>" + val.UserNo + "</TD>"
                        str += "<TD>" + val.UserId + "</TD>"
                        str += "<TD>" + val.Payment + "</TD>"
                        str += "<TD style=\"text-align:right\">" + val.ChargePaidAmount + "</TD>"
                        str += "<TD style=\"text-align:right\">" + val.ChargeCashAmount.toLocaleString('ko-KR') + "원" + "</TD>"
                        str += "<TD style=\"text-align:right\">" + val.CashRemain.toLocaleString('ko-KR') + "원" + "</TD>"
                        str += "<TD>"
                        if (val.CashStatus == "취소")
                            str += "<font color=\"red\">"
                        str += val.CashStatus
                        if (val.CashStatus == "취소")
                            str += "</font>"
                        str += "</TD>"
                        str += "<TD>" + val.RegDate + "</TD>"
                        str += "<TD>"
                        str += val.RefundDate
                        str += "</TD>"
                        str += "</TR>"
                        totalPageCount = val.TotalPageCount;
                    });
                    /*페이징 번호*/
                    var start = parseInt((pageNumber - 1) / 5, 10) * 5 + 1;
                    var pageStr = "";
                    if (start != 1)
                        pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + (start - 1) + "\">" + "<div id=\"btnchkbefore\" class=\"btn btn-default\"><</div></a>"

                    if (start == (parseInt((totalPageCount - 1) / 5, 10) * 5 + 1)) { // 마지막 페이지Set인지 확인
                        var count = totalPageCount - start;
                        for (var i = start; i <= totalPageCount; i++) {
                            pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                            if (pageNumber == i)
                                pageStr += "warning\">"
                            else
                                pageStr += "default\">"
                            pageStr += i + "</div></a>"
                        }
                    } else {
                        for (var i = start; i < start + 5; i++) {
                            pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + i + "\"><div id=\"" + "btnchk" + i + "\" class=\"btn btn-"
                            if (pageNumber == i)
                                pageStr += "warning\">"
                            else
                                pageStr += "default\">"
                            pageStr += i + "</div></a>"
                        }
                        pageStr += "<a href=\"javascript:void(0);\" class=\"chargeBtn\" data-no=\"" + (start + 5) + "\"><div id=\"btnchkbefore\" class=\"btn btn-default\">" + "></div></a>"
                    }
                    $("#tablList").append(str);
                    if (dataLength != 0)
                        $("#pageBtn").append(pageStr);
                    else
                        $('#pageBtn').empty();

                },
                error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                    alert("통신 실패.")
                }
            });
        });

        /*계좌 상태 버튼*/
        $('#showAccountStatus').click(function () {

            if (userNo != 0) {
                var urlData = '@Url.Action("ShowUserTotalCash", "Admin")' + "?&UserNo=" + userNo;
                $.ajax({
                    type: "GET",            // HTTP method type(GET, POST) 형식이다.
                    url: urlData,            // Json 형식의 데이터이다.
                    success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                        var objJson = jQuery.parseJSON(data);
                        var dataLength = Object.keys(objJson).length;
                        var str = "";
                        $('#tablList').empty(); // 테이블 비우기
                        $("#pageBtn").empty();
                        $.each(objJson, function (i, val) {
                            str += "<TR>"
                            str += "<TH>총 기프티캐시</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TD colspan=\"2\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>충전 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>보너스 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>판매금 캐시(잔액)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TD colspan=\"2\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TD colspan=\"4\"></TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 충전 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 충전 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.GiftiCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 보너스 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 보너스 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.BonusCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TH>총 판매금 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "<TH>사용한 판매금 캐시(누계)</TH>"
                            str += "<TD style=\"text-align:right\">"
                            str += val.SellingCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                            str += "</TD>"
                            str += "</TR>"

                            str += "<TR>"
                            str += "<TD colspan=\"4\"></TD>"
                            str += "</TR>"
                        });
                        $("#tablList").append(str);
                        document.getElementById("title").innerHTML = "계좌 상태";
                    },
                    error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                        alert("통신 실패.")
                    }
                });
            }
        })

        /*아이디 검색*/
        $('#checkUser').click(function () {

            var userId = "";
            userNo = 0;

            userId = $('#userId').val();
            var urlData = '@Url.Action("CheckIsExist", "Product")' + "?UserId=" + userId;
            $.ajax({
                type: "GET",            // HTTP method type(GET, POST) 형식이다.
                url: urlData,            // Json 형식의 데이터이다.
                success: function (data) { // 비동기통신의 성공일경우 success콜백으로 들어옵니다. 'res'는 응답받은 데이터이다.
                    var objJson = jQuery.parseJSON(data);
                    var dataLength = Object.keys(objJson).length;
                    $("#pageBtn").empty();
                    console.log("success");
                    startDate = null;
                    endDate = null;

                    $.each(objJson, function (i, val) {
                        console.log(val.UserNo);
                        isExist = 0;
                        if (val.UserNo != 0) { // 유저가 존재함
                            isExist = 1;
                            userNo = val.UserNo;
                        }
                        if (userNo != 0)
                            document.getElementById("IuserNo").innerHTML = val.UserNo;
                        else
                            document.getElementById("IuserNo").innerHTML = "";
                        document.getElementById("IuserId").innerHTML = val.UserId;
                        document.getElementById("IuserName").innerHTML = val.UserName;
                        document.getElementById("Ibirth").innerHTML = val.UserBirth;
                        document.getElementById("IregDate").innerHTML = val.RegDate;
                    });
                    if (isExist == 0) {
                        isExist = 0;
                        userNo = 0;
                        $('#tablList').empty(); // 테이블 비우기
                        $('#title').empty(); // 테이블 비우기
                        alert("존재하지 않는 유저입니다.");
                    }

                    /*유저가 존재하면 계좌 상태 출력*/
                    if (userNo != 0) {
                        urlData = '@Url.Action("ShowUserTotalCash", "Admin")' + "?&UserNo=" + userNo;
                        $.ajax({
                            type: "GET",            // HTTP method type(GET, POST) 형식이다.
                            url: urlData,            // Json 형식의 데이터이다.
                            success: function (data) { // 여기부터 수정해야함 - 테이블 헤더 데이터 수정
                                var objJson = jQuery.parseJSON(data);
                                var dataLength = Object.keys(objJson).length;
                                var str = "";
                                $('#tablList').empty(); // 테이블 비우기
                                $.each(objJson, function (i, val) {
                                    str += "<TR>"
                                    str += "<TH>총 기프티캐시</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.TotalCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TD colspan=\"2\"></TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TH>충전 캐시(잔액)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.GiftiCash.TotalCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TH>보너스 캐시(잔액)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.BonusCash.TotalCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TH>판매금 캐시(잔액)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.SellingCash.TotalCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TD colspan=\"2\"></TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TD colspan=\"4\"></TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TH>총 충전 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.GiftiCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TH>사용한 충전 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.GiftiCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TH>총 보너스 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.BonusCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TH>사용한 보너스 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.BonusCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TH>총 판매금 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.SellingCash.TotalIncomeCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "<TH>사용한 판매금 캐시(누계)</TH>"
                                    str += "<TD style=\"text-align:right\">"
                                    str += val.SellingCash.TotalWithdrawCash.toLocaleString('ko-KR') + "원"
                                    str += "</TD>"
                                    str += "</TR>"

                                    str += "<TR>"
                                    str += "<TD colspan=\"4\"></TD>"
                                    str += "</TR>"
                                });
                                $("#tablList").append(str);
                                document.getElementById("title").innerHTML = "계좌 상태";
                            },
                            error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                                alert("통신 실패.")
                            }
                        });
                    }
                },
                error: function (XMLHttpRequest, textStatus, errorThrown) { // 비동기 통신이 실패할경우 error 콜백으로 들어옵니다.
                    alert("통신 실패.")
                }
            });
        })

        /*날짜 박스 API*/
        var today = new Date();
        var picker = tui.DatePicker.createRangePicker({
            startpicker: {
                date: new Date(today.getFullYear(), today.getMonth(), 1),
                input: '#startDate',
                container: '#startpicker-container'
            },
            endpicker: {
                date: today,
                input: '#endDate',
                container: '#endpicker-container'
            },
            selectableRanges: [
                [null, new Date()]
            ],
            language: 'ko'
        });
    </script>
}